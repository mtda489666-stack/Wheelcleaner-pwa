<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root{--accent:#0066cc;--muted:#666;--card:#fff;--bg:#f5f7fb}
    *{box-sizing:border-box}
    body{font-family:Inter, system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial; margin:0; background:var(--bg); color:#111}
    header{background:#fff;padding:20px 24px;border-bottom:1px solid #e6edf3;display:flex;align-items:center;gap:16px}
    .logo{font-weight:700;color:var(--accent);font-size:20px}
    .container{max-width:1200px;margin:20px auto;padding:0 16px}

    .confirmation-message{padding:20px;background:var(--card);border-radius:8px;border:1px solid #e6eef6;text-align:center;margin-bottom:20px}
    .confirmation-message h2{font-size:24px;color:#0b2540}
    .confirmation-message p{font-size:16px;color:var(--muted)}

    .pay-section{padding:20px;background:var(--card);border-radius:8px;border:1px solid #e6eef6;text-align:center}
    .price{font-size:20px;font-weight:700;color:#0b2540;margin:12px 0}
    #paypal-button-container{display:inline-block}
    .success{color:green;margin-top:12px}
    .error{color:#b00020;margin-top:12px}

    footer{padding:30px;text-align:center;color:var(--muted)}
  </style>
</head>
<body>
  <header>
    <div class="logo">Wheelcleaner</div>
  </header>

  <main class="container">
    <section class="confirmation-message" id="confirmationMessage">
      <!-- Confirmation message injected here -->
    </section>

    <!-- PayPal checkout section -->
    <section class="pay-section" id="paySection" style="display:none">
      <div id="orderSummary" aria-live="polite"></div>
      <div class="price" id="orderPrice"></div>
      <div id="paypal-button-container"></div>
      <div id="paymentResult"></div>
    </section>
  </main>

  <footer>
    <p>Any questions or suggestions? Please let us know.</p>
  </footer>

  <!--
    IMPORTANT:
    - Replace "Ac56s2jq05YpX1mUQDpNc14mQCrd3x-vh5fdepzvP-vgZLiArDkxMInSIbpkn8joIWGK7C5ZS3vGkcQZ_CLIENT_ID" with your actual PayPal Client ID.
    - For sandbox testing use a sandbox client id and the sandbox environment (https://www.paypal.com/sdk/js?client-id=...&currency=USD).
    - For production replace with your live client id.
  -->
  <script src="https://www.paypal.com/sdk/js?client-id=Ac56s2jq05YpX1mUQDpNc14mQCrd3x-vh5fdepzvP-vgZLiArDkxMInSIbpkn8joIWGK7C5ZS3vGkcQZ_CLIENT_ID&currency=USD"></script>

  <script>
    // Product data matching the previous files
    const products = [
      { id: 1, title: 'High Purity Cleaner 110-63-4 Industrial Grade — 10000ml', price: '$250' },
      { id: 2, title: 'Factory Direct Cleaner CAS 110-63-4 — 3000ml', price: '$650' },
      { id: 3, title: 'Butanedioic Acid 110-63-4 Free Samples Available — 5000ml', price: '$800' },
      { id: 4, title: 'Customizable 110-63-4 Cleaner for Cosmetics — 2000ml', price: '$450' },
      { id: 5, title: 'Bulk Wholesale Cleaner 110-63-4 with Local Shipping — 8000ml', price: '$1200' },
      { id: 6, title: 'Premium Grade 110-63-4 for Research — 1000ml', price: '$220' },
      { id: 7, title: '110-63-4 Succinic Acid Derivative Wholesale — 4000ml', price: '$400' },
      { id: 8, title: 'High Quality Cleaner 110-63-4 Bulk Supply — 6000ml', price: '$700' },
      { id: 9, title: 'Industrial Cleaner CAS 110-63-4 — 2500ml', price: '$600' },
      { id: 10, title: '99.9% Pure Cleaner 110-63-4 — 7000ml', price: '$1200' },
      { id: 11, title: 'Fast Delivery Cleaner 110-63-4 US Stock — 1500ml', price: '$300' },
      { id: 12, title: 'Eco-Friendly 110-63-4 Cleaner — 9000ml', price: '$1800' },
      { id: 13, title: 'Professional Grade Cleaner for Wheels 110-63-4 — 3500ml', price: '$750' },
      { id: 14, title: 'Bulk Pack Cleaner 110-63-4 Free Shipping — 5000ml', price: '$800' },
      { id: 15, title: 'High Concentration 110-63-4 Cleaner — 2000ml', price: '$400' },
      { id: 16, title: 'US Warehouse Cleaner 110-63-4 — 4000ml', price: '$780' },
      { id: 17, title: 'Foaming Cleaner 110-63-4 — 6000ml', price: '$900' },
      { id: 18, title: 'Research Lab Cleaner 110-63-4 — 1000ml', price: '$200' },
      { id: 19, title: 'Economic Cleaner 110-63-4 Bulk — 8000ml', price: '$1200' }
    ];

    // Get product ID from URL parameter (passed from buynow.html)
    const urlParams = new URLSearchParams(window.location.search);
    const productId = parseInt(urlParams.get('id')) || 1; // Default to 1 if no ID
    const product = products.find(p => p.id === productId) || products[0];

    // Extract unit amount from title (e.g., "10000ml")
    const unitMatch = product.title.match(/—\s*(\d+ml)/i);
    const unitAmount = unitMatch ? unitMatch[1] : 'Unknown Quantity';

    // Set page title with confirmation and unit amount
    document.title = `Purchase Confirmation - ${product.title.split(' — ')[0]} ${unitAmount} | Wheelcleaner`;

    // Helper to escape HTML
    function escapeHtml(str) {
      return String(str).replace(/[&<>\"']/g, (m) => ({'&':'&amp;','<':'&lt;','>':'&gt;','\"':'&quot;',"'":"&#39;"}[m]));
    }

    // Parse numeric amount from price string like "$250" -> 250.00
    function parseAmount(priceStr) {
      const n = parseFloat(priceStr.replace(/[^0-9.-]+/g, ""));
      return isNaN(n) ? 0 : n.toFixed(2);
    }

    // Render confirmation message and show PayPal section
    const messageSection = document.getElementById('confirmationMessage');
    const paySection = document.getElementById('paySection');
    const orderSummary = document.getElementById('orderSummary');
    const orderPrice = document.getElementById('orderPrice');
    const paymentResult = document.getElementById('paymentResult');

    const amount = parseAmount(product.price);
    messageSection.innerHTML = `
      <h2>Thank You — Ready to Checkout</h2>
      <p>You are about to purchase <strong>${escapeHtml(product.title)}</strong> for <strong>${escapeHtml(product.price)}</strong>.</p>
      <p>Please complete your payment using PayPal below. You will receive an email confirmation from PayPal after successful payment.</p>
    `;

    orderSummary.innerHTML = `<div><strong>Item:</strong> ${escapeHtml(product.title)}</div>`;
    orderPrice.textContent = `${product.price}`;

    // Show PayPal section now that data is ready
    paySection.style.display = 'block';

    // Ensure paypal SDK loaded
    if (typeof paypal === 'undefined') {
      paymentResult.innerHTML = '<div class="error">PayPal SDK failed to load. Make sure you replaced the client id in the script URL.</div>';
    } else {
      // Render PayPal Buttons
      paypal.Buttons({
        style: {
          layout: 'vertical',
          color:  'blue',
          shape:  'rect',
          label:  'paypal'
        },
        createOrder: function(data, actions) {
          // Create the order on the client. For production it's recommended to create order on your server.
          return actions.order.create({
            purchase_units: [{
              amount: {
                value: amount.toString(), // decimal string, e.g. "250.00"
                currency_code: 'USD'
              },
              description: product.title
            }],
            application_context: {
              brand_name: 'Wheelcleaner',
              shipping_preference: 'NO_SHIPPING' // change if shipping required
            }
          });
        },
        onApprove: function(data, actions) {
          return actions.order.capture().then(function(details) {
            // Show a success message to the buyer
            paymentResult.innerHTML = `<div class="success">Payment completed by <strong>${escapeHtml(details.payer.name.given_name || '')} ${escapeHtml(details.payer.name.surname || '')}</strong>. Transaction ID: <code>${escapeHtml(details.id)}</code></div>`;
            // Optionally: send details to your server to fulfill the order
            console.log('Order details', details);
            // Update page title / content if desired
            messageSection.innerHTML = `
              <h2>Payment Confirmed</h2>
              <p>Thank you! Your payment for <strong>${escapeHtml(product.title)}</strong> was successful.</p>
              <p>Transaction ID: <code>${escapeHtml(details.id)}</code></p>
            `;
          });
        },
        onCancel: function (data) {
          paymentResult.innerHTML = `<div class="error">Payment was cancelled. You can try again or contact support.</div>`;
        },
        onError: function (err) {
          console.error(err);
          paymentResult.innerHTML = `<div class="error">An error occurred during payment. Please try again later.</div>`;
        }
      }).render('#paypal-button-container');
    }
  </script>
</body>
</html>
